<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Force Map</title>
		<script type="text/javascript" src="../lib/d3.js"></script>
		<style>

		.links line {
		  stroke: #999;
		  stroke-opacity: 0.6;
		}
		
		.nodes circle {
		  stroke: #fff;
		  stroke-width: 1.5px;
		}
		svg{
			background: url(data:image/png;base64,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) no-repeat;
		}
		</style>
	</head>
	<body>
		<svg width="960" height="600"></svg>
	</body>
	<script>
	var svg = d3.select("svg"),
	    width = +svg.attr("width"),
	    height = +svg.attr("height");
	
	var color = d3.scaleOrdinal(d3.schemeCategory20);
	
	var simulation = d3.forceSimulation()
	    .force("link", d3.forceLink().distance(80).id(function(d) { return d.id; }))
	    .force("charge", d3.forceManyBody())
	    .force("center", d3.forceCenter(width / 2, height / 2))

	d3.json("miserables.json", function(error, graph) {
	  if (error) throw error;
	//权重线
	  var link = svg.append("g")
	      .attr("class", "links")
	    .selectAll("line")
	    .data(graph.links)
	    .enter().append("line")
	      .attr("stroke-width", function(d) { return Math.sqrt(d.value); })
	      .style("stroke",function(d) { if(d.value>=5 && d.value<10){
			return "skyblue"	      	
	      }else if(d.value>=10 && d.value<=15){
	      	return "purple"
	      }else if(d.value>15){
	      	return "deepgreen"
	      }
	      })
	  //绘点
	  var node = svg.append("g")
	      .attr("class", "nodes")
	    .selectAll("circle")
	    .data(graph.nodes)
	    .enter().append("circle")
	      .attr("r", 8)
	      .attr("fill", function(d) { return color(d.group); })
	      .call(d3.drag()
	          .on("start", dragstarted)
	          .on("drag", dragged)
	          .on("end", dragended))

	var nodet = svg.append("g")
	      			.attr("class", "text")
	      			.selectAll("text")
					.data(graph.nodes)
					.enter().append("text")
					.attr("dy", ".002em")
      				.attr("fill", function(d) { return color(d.group); })
      				.text(function(d) { return d.id; })
				      .call(d3.drag()
				          .on("start", dragstarted)
				          .on("drag", dragged)
				          .on("end", dragended))
	
	
	  simulation
	      .nodes(graph.nodes)
	      .on("tick", ticked);
	
	  simulation.force("link")
	      .links(graph.links);
	
	  function ticked() {
	    link
	        .attr("x1", function(d) { return d.source.x; })
	        .attr("y1", function(d) { return d.source.y; })
	        .attr("x2", function(d) { return d.target.x; })
	        .attr("y2", function(d) { return d.target.y; });
	
	    node
	        .attr("cx", function(d) { return d.x; })
	        .attr("cy", function(d) { return d.y; });
	        
	    nodet
	    	.attr("transform", function(d) { return "translate(" + (d.x+10) + "," + (d.y+5) + ")"; });
	  }
	});
	
	function dragstarted(d) {
	  if (!d3.event.active) simulation.alphaTarget(0.3).restart();
	  d.fx = d.x;
	  d.fy = d.y;
	}
	
	function dragged(d) {
	  d.fx = d3.event.x;
	  d.fy = d3.event.y;
	}
	
	function dragended(d) {
	  if (!d3.event.active) simulation.alphaTarget(0);
	  d.fx = null;
	  d.fy = null;
	}
	
	</script>
</html>
